var using_mobile=detect_mobile("any"),canvas_container=null,canvas=null,renderer=null,scene=null;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
var request_animation_frame_id=null,clock=null,time_delta=null,origin=null,initial_camera_look_at_object=null,fog=null,beginning_fog_density=1,ending_fog_density=.1,camera=null,sunlight=null,use_trackball_controls=!1,trackball_controls=null,MOUSE_LOOK_SPEED_DEFAULT=.2,mouse_look_speed=MOUSE_LOOK_SPEED_DEFAULT,mouse_coordinates=[window.innerWidth/2,window.innerHeight/2],mouse_left_is_down=!1,mouse_left_is_up=!0,mouse_left_is_being_held_down=!1,mouse_left_down_timeout=null,touch_is_down=!1,touch_is_being_held_down=
!1,touch_down_timeout=null,horizontal_look_angle=0,vertical_look_angle=0,projector=null,raycaster=null,intersecting_object_id=-1,ray_mouse=[0,0],main_model=null,logo_model=null,glass_panes_model=null,buildings_model=null,bird_model=null,desk_model=null,computer_model=null,picture_frame_model=null,blocks_model=null,film_reel_model=null,phone_model=null,mannequin_model=null,outlines_model=null,AUDIO_ON_SYMBOL="<span class='lettier-icon-audio_on'></span>",AUDIO_OFF_SYMBOL="<span class='lettier-icon-audio_off'></span>",
VOLUME_HIGH=.6,VOLUME_LOW=0,audio_is_on=0,background_noise_sound_effect=null,pop_sound_effect=null,opening_animation_tween=null,overlay_is_out=!1;function on_load(){initialize_3D_scene();window.requestAnimationFrame(draw)}
function initialize_3D_scene(){canvas_container=document.createElement("div");canvas_container.id="canvas_container";canvas_container.className="canvas_container";document.body.appendChild(canvas_container);canvas=document.createElement("canvas");canvas.id="canvas";canvas.innerHTML="Your browser does not support the HTML5 canvas tag.";canvas.width=window.innerWidth;canvas.height=window.innerHeight;canvas_container.appendChild(canvas);renderer=Detector.webgl?new THREE.WebGLRenderer({canvas:canvas,
antialias:!0,clearColor:16777215,clearAlpha:0,alpha:!0,precision:"mediump"}):new THREE.CanvasRenderer({canvas:canvas,antialias:!0,clearColor:16777215,clearAlpha:0,alpha:!0});renderer.setSize(window.innerWidth,window.innerHeight);canvas_container.appendChild(renderer.domElement);try{log_visitor_data("WEBGL_EXTS="+renderer.context.getSupportedExtensions().join(","))}catch(a){log_visitor_data("WEBGL_EXTS=")}scene=new THREE.Scene;projector=new THREE.Projector;raycaster=new THREE.Raycaster;scene.fog=new THREE.FogExp2(3291456,
beginning_fog_density);fog=scene.fog;origin=new THREE.Vector3(0,0,0);initial_camera_look_at_object=new THREE.Object3D;initial_camera_look_at_object.position.set(-4,-.2,-3.5);camera=new THREE.PerspectiveCamera(45,canvas_container.offsetWidth/canvas_container.offsetHeight,.1,1E3);camera.position.set(0,-.2,2.9);camera.rotation.order="YXZ";scene.add(camera);camera.lookAt(initial_camera_look_at_object.position);horizontal_look_angle=-camera.rotation.y;vertical_look_angle=camera.rotation.x;renderer.shadowMapEnabled=
!0;renderer.shadowMapSoft=!1;renderer.shadowMapCullFace=THREE.CullFaceFront;var d=new THREE.AmbientLight(3291456);scene.add(d);d=new THREE.SpotLight(14801313);d.position.set(-15,2,5);d.target.position.set(-2,-1,0);d.distance=camera.far;d.castShadow=!0;d.shadowCameraVisible=!1;d.shadowBias=.009;d.shadowCameraNear=9;d.shadowCameraFar=camera.far;d.shadowCameraFov=45;d.shadowDarkness=.35;d.shadowMapWidth=512;d.shadowMapHeight=512;d.intensity=1;scene.add(d);sunlight=d;d=new THREE.PointLight(14801313,1.2,
50);d.position.set(.13,2.75,3);scene.add(d);use_trackball_controls&&(trackball_controls=new THREE.TrackballControls(camera,renderer.domElement),trackball_controls.rotateSpeed=1,trackball_controls.zoomSpeed=1.2,trackball_controls.panSpeed=.2,trackball_controls.noZoom=!1,trackball_controls.noPan=!1,trackball_controls.noRotate=!1,trackball_controls.staticMoving=!1,trackball_controls.dynamicDampingFactor=.3,trackball_controls.minDistance=1.1,trackball_controls.maxDistance=100,trackball_controls.keys=
[16,17,18],trackball_controls.target=initial_camera_look_at_object.position);clock=new THREE.Clock;d=new THREE.JSONLoader;d.load("assets/models/buildings.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshPhongMaterial({color:3355443,ambient:4541017,emissive:1118481,specular:9097694,shading:THREE.FlatShading,shininess:1E3}));b.castShadow=!1;b.receiveShadow=!1;scene.add(b);buildings_model=b},"assets/models/");d.load("assets/models/bird.js",
function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.SmoothShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);bird_model=b},"assets/models/textures/");d.load("assets/models/glass_panes.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.DoubleSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!1,b.receiveShadow=!0);scene.add(b);glass_panes_model=
b},"assets/models/");d.load("assets/models/main.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);main_model=b},"assets/models/");d.load("assets/models/logo.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=
!1);scene.add(b);logo_model=b},"assets/models/");d.load("assets/models/desk.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);desk_model=b},"assets/models/");d.load("assets/models/computer.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));
using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);computer_model=b},"assets/models/textures/");d.load("assets/models/picture_frame.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);picture_frame_model=b},"assets/models/textures/");d.load("assets/models/blocks.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,
c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);blocks_model=b},"assets/models/");d.load("assets/models/film_reel.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.FlatShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);film_reel_model=b},"assets/models/");d.load("assets/models/phone.js",function(a,
c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.SmoothShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);phone_model=b},"assets/models/");d.load("assets/models/mannequin.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.SmoothShading;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));using_mobile||(b.castShadow=!0,b.receiveShadow=!0);scene.add(b);mannequin_model=b},"assets/models/");
d.load("assets/models/outlines.js",function(a,c){for(var b=c.length;b--;)c[b].side=THREE.FrontSide,c[b].shading=THREE.None;b=new THREE.Mesh(a,new THREE.MeshFaceMaterial(c));b.castShadow=!1;b.receiveShadow=!1;scene.add(b);outlines_model=b},"assets/models/");window.onresize=on_window_resize_callback;using_mobile?(canvas.addEventListener("touchstart",on_touch_start_callback,!1),canvas.addEventListener("touchend",on_touch_end_callback,!1),canvas.addEventListener("touchmove",on_touch_move_callback,!1)):
(window.onmousemove=on_mouse_move_callback,window.onmousedown=on_mouse_down_callback,window.onmouseup=on_mouse_up_callback);var f={fog_density:beginning_fog_density},d={fog_density:ending_fog_density};opening_animation_tween=(new TWEEN.Tween(f)).to(d,2E3);opening_animation_tween.easing(TWEEN.Easing.Circular.In);opening_animation_tween.onUpdate(function(){fog.density=f.fog_density});opening_animation_tween.delay(500);opening_animation_tween.start();initialize_audio();initialize_help_button()}
function initialize_audio(){var a=document.createElement("div");a.id="audio_control_button";a.className="audio_control_button";a.innerHTML=AUDIO_OFF_SYMBOL;a.title="Turn Audio On";document.body.appendChild(a);a.onmouseup=function(){toggle_audio()};audio_is_on=0;background_noise_sound_effect=document.createElement("audio");background_noise_sound_effect.id="background_noise_sound_effect";background_noise_sound_effect.preload="auto";background_noise_sound_effect.volume=VOLUME_LOW;background_noise_sound_effect.loop=
!0;background_noise_sound_effect.autoplay="autoplay";document.body.appendChild(background_noise_sound_effect);background_noise_sound_effect.on_can_play=function(){document.getElementById("audio_control_button").style.visibility="visible";background_noise_sound_effect.removeEventListener("canplay",background_noise_sound_effect.on_can_play);background_noise_sound_effect.load();background_noise_sound_effect.play()};background_noise_sound_effect.addEventListener("canplay",background_noise_sound_effect.on_can_play,
!1);a=document.createElement("source");""!=background_noise_sound_effect.canPlayType("audio/ogg")?(a.type="audio/ogg",a.src="assets/audio/ogg/background.ogg"):(a.type="audio/mpeg",a.src="assets/audio/mp3/background.mp3");background_noise_sound_effect.appendChild(a);pop_sound_effect=document.createElement("audio");pop_sound_effect.id="pop_sound_effect";pop_sound_effect.preload="auto";pop_sound_effect.volume=VOLUME_LOW;pop_sound_effect.loop=!1;pop_sound_effect.autoplay="autoplay";document.body.appendChild(pop_sound_effect);
pop_sound_effect.on_can_play=function(){document.getElementById("audio_control_button").style.visibility="visible";pop_sound_effect.removeEventListener("canplay",pop_sound_effect.on_can_play);pop_sound_effect.load();pop_sound_effect.play()};pop_sound_effect.addEventListener("canplay",pop_sound_effect.on_can_play,!1);a=document.createElement("source");""!=pop_sound_effect.canPlayType("audio/ogg")?(a.type="audio/ogg",a.src="assets/audio/ogg/pop.ogg"):(a.type="audio/mpeg",a.src="assets/audio/mp3/pop.mp3");
pop_sound_effect.appendChild(a)}function initialize_help_button(){var a=document.createElement("div");a.id="help_button";a.className="help_button";a.innerHTML="?";a.title="Help";document.body.appendChild(a);a.onmouseup=function(){create_overlay("assets/content/help.html")};var d=document.getElementById("audio_control_button");a.style.top=d.offsetTop+d.clientHeight+5+"px"}
function toggle_audio(a){1===audio_is_on?(document.getElementById("background_noise_sound_effect").volume=VOLUME_LOW,document.getElementById("pop_sound_effect").volume=VOLUME_LOW,document.getElementById("audio_control_button").innerHTML=AUDIO_OFF_SYMBOL,document.getElementById("audio_control_button").title="Turn Audio On",audio_is_on=0):(document.getElementById("background_noise_sound_effect").volume=VOLUME_HIGH,document.getElementById("pop_sound_effect").volume=VOLUME_HIGH,document.getElementById("audio_control_button").innerHTML=
AUDIO_ON_SYMBOL,document.getElementById("audio_control_button").title="Turn Audio Off",audio_is_on=1)}function on_window_resize_callback(a){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);overlay_is_out&&(size_overlay_content_container(),size_contact_form())}
function on_mouse_move_callback(a){a.preventDefault();if(overlay_is_out)return null;mouse_coordinates[0]=a.clientX;mouse_coordinates[1]=a.clientY;if(!mouse_left_is_being_held_down&&null!=outlines_model&&(ray_mouse[0]=mouse_coordinates[0]/window.innerWidth*2-1,ray_mouse[1]=2*-(mouse_coordinates[1]/window.innerHeight)+1,a=new THREE.Vector3(ray_mouse[0],ray_mouse[1],1),projector.unprojectVector(a,camera),raycaster.set(camera.position,a.sub(camera.position).normalize()),a=raycaster.intersectObjects(scene.children,
!0),0!=a.length))switch(intersecting_object_id=a[0].object.id===glass_panes_model.id&&2<=a.length?a[1].object.id:a[0].object.id,destroy_tooltip(),intersecting_object_id){case computer_model.id:create_tooltip("Code");canvas_container.style.cursor="pointer";break;case blocks_model.id:create_tooltip("Projects");canvas_container.style.cursor="pointer";break;case mannequin_model.id:create_tooltip("3D Models");canvas_container.style.cursor="pointer";break;case phone_model.id:create_tooltip("Contact");canvas_container.style.cursor=
"pointer";break;case logo_model.id:create_tooltip("About");canvas_container.style.cursor="pointer";break;case bird_model.id:create_tooltip("Twitter");canvas_container.style.cursor="pointer";break;case film_reel_model.id:create_tooltip("Videos");canvas_container.style.cursor="pointer";break;case picture_frame_model.id:create_tooltip("Photos");canvas_container.style.cursor="pointer";break;default:destroy_tooltip(),canvas_container.title="",canvas_container.style.cursor="default",intersecting_object_id=
-1}}function on_mouse_down_callback(a){if(overlay_is_out)return null;a.preventDefault();a=a||window.event;1===(a.which||a.button)&&(mouse_left_is_down=!0,mouse_left_is_up=!1,mouse_left_down_timeout=window.setTimeout(function(){canvas_container.style.cursor="move";mouse_left_is_being_held_down=!0},200))}
function on_mouse_up_callback(a){if(overlay_is_out)return null;a.preventDefault();a=a||window.event;if(1===(a.which||a.button)){if(!mouse_left_is_being_held_down){switch(intersecting_object_id){case computer_model.id:window.open("https://github.com/lettier?tab=repositories");break;case blocks_model.id:create_overlay("assets/content/projects.html");break;case mannequin_model.id:window.open("https://sketchfab.com/lettier/recent");break;case phone_model.id:create_overlay("assets/content/contact.html");
break;case logo_model.id:create_overlay("assets/content/about.html");break;case bird_model.id:window.open("https://twitter.com/lettier/");break;case film_reel_model.id:window.open("https://www.youtube.com/user/llettier");break;case picture_frame_model.id:window.open("https://secure.flickr.com/photos/30908838@N04/")}intersecting_object_id=-1}mouse_left_is_down=!1;mouse_left_is_up=!0;mouse_left_is_being_held_down=!1;canvas_container.style.cursor="default";window.clearInterval(mouse_left_down_timeout);
mouse_left_down_timeout=null}}
function on_touch_move_callback(a){a.preventDefault();if(overlay_is_out)return null;mouse_coordinates[0]=a.touches[0].clientX;mouse_coordinates[1]=a.touches[0].clientY;touch_is_being_held_down||null==outlines_model||(ray_mouse[0]=mouse_coordinates[0]/window.innerWidth*2-1,ray_mouse[1]=2*-(mouse_coordinates[1]/window.innerHeight)+1,a=new THREE.Vector3(ray_mouse[0],ray_mouse[1],1),projector.unprojectVector(a,camera),raycaster.set(camera.position,a.sub(camera.position).normalize()),a=raycaster.intersectObjects(scene.children,
!0),0!=a.length&&(intersecting_object_id=a[0].object.id===glass_panes_model.id&&2<=a.length?a[1].object.id:a[0].object.id))}function on_touch_start_callback(a){a.preventDefault();if(overlay_is_out)return null;touch_is_down=!0;touch_down_timeout=window.setTimeout(function(){touch_is_being_held_down=!0},200);on_touch_move_callback(a)}
function on_touch_end_callback(a){a.preventDefault();if(overlay_is_out)return null;if(!touch_is_being_held_down){switch(intersecting_object_id){case computer_model.id:window.open("https://github.com/lettier?tab=repositories");break;case blocks_model.id:create_overlay("assets/content/projects.html");break;case mannequin_model.id:window.open("https://sketchfab.com/lettier/recent");break;case phone_model.id:create_overlay("assets/content/contact.html");break;case logo_model.id:create_overlay("assets/content/about.html");
break;case bird_model.id:window.open("https://twitter.com/lettier/");break;case film_reel_model.id:window.open("https://www.youtube.com/user/llettier");break;case picture_frame_model.id:window.open("https://secure.flickr.com/photos/30908838@N04/")}intersecting_object_id=-1}touch_is_being_held_down=touch_is_down=!1;window.clearInterval(touch_down_timeout);touch_down_timeout=null}
function create_tooltip(a){var d=document.createElement("div");d.id="tooltip";d.className="tooltip";d.innerHTML=a;document.body.appendChild(d);d.style.left=mouse_coordinates[0]-d.clientWidth+"px";d.style.top=mouse_coordinates[1]-d.clientHeight+"px";var f={tooltip_opacity:0};a=(new TWEEN.Tween(f)).to({tooltip_opacity:1},200);a.easing(TWEEN.Easing.Circular.In);a.onUpdate(function(){d.style.opacity=f.tooltip_opacity});a.delay(0);a.start()}
function destroy_tooltip(){try{var a=document.getElementById("tooltip");a.parentNode.removeChild(a)}catch(d){}}
function draw(a){request_animation_frame_id=window.requestAnimationFrame(draw);use_trackball_controls&&trackball_controls.update();a=clock.getDelta();TWEEN.update();if((mouse_left_is_down||touch_is_down)&&(mouse_left_is_being_held_down||touch_is_being_held_down)&&!use_trackball_controls&&!overlay_is_out){var d=(window.innerHeight/2-mouse_coordinates[1])/(window.innerHeight/2*1);horizontal_look_angle+=(window.innerWidth/2-mouse_coordinates[0])/(window.innerWidth/2*-1)*a*mouse_look_speed*Math.PI*1;
vertical_look_angle+=mouse_look_speed*a*d*Math.PI*1;horizontal_look_angle=Math.max(.25*-Math.PI,Math.min(.05*Math.PI,horizontal_look_angle));vertical_look_angle=Math.max(.1*-Math.PI,Math.min(.1*Math.PI,vertical_look_angle));camera.rotation.x=vertical_look_angle;camera.rotation.y=-horizontal_look_angle;camera.rotation.z=0}renderer.render(scene,camera)}
function detect_mobile(a){switch(a){case "android":return navigator.userAgent.match(/Android/i);case "blackberry":return navigator.userAgent.match(/BlackBerry/i);case "ios":return navigator.userAgent.match(/iPhone|iPad|iPod/i);case "opera":return navigator.userAgent.match(/Opera Mini/i);case "windows":return navigator.userAgent.match(/IEMobile/i);case "any":return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Opera Mini/i)||
navigator.userAgent.match(/IEMobile/i);default:return!1}}
function create_overlay(a){function d(){4===b.readyState&&(200===b.status?(document.getElementById("overlay_content_container").innerHTML=b.responseText,-1!=a.search("contact")&&initialize_contact_form()):console.log("Failed to load overlay content."))}try{document.getElementById("audio_control_button").style.visibility="hidden"}catch(f){}overlay_is_out=!0;var e=document.createElement("div");e.id="overlay_container";e.className="overlay_container";var c=document.createElement("div");c.id="overlay_content_container";
c.className="overlay_content_container";document.body.appendChild(e);e.appendChild(c);size_overlay_content_container();c=document.createElement("div");c.className="close_button";c.innerHTML="X";c.title="Close";c.onselectstart=function(){return!0};c.addEventListener("mouseup",destroy_overlay,!1);e.appendChild(c);var b;(function(a){if(window.XMLHttpRequest)b=new XMLHttpRequest;else if(window.ActiveXObject)try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){}}if(!b)return console.log("Failed to fetch overlay content."),
!1;b.onreadystatechange=d;b.open("GET",a);b.send()})(a);pop_sound_effect.play()}
function size_overlay_content_container(){try{var a=document.getElementById("overlay_content_container");720<=window.innerWidth?(a.style.width="560px",a.style.fontSize="inherit"):640<=window.innerWidth?(a.style.width="480px",a.style.fontSize="inherit"):480<=window.innerWidth?(a.style.width="320px",a.style.fontSize="85%"):320<=window.innerWidth?(a.style.width="160px",a.style.fontSize="65%"):(a.style.width=(window.innerWidth-(-160+window.innerWidth))/2+"px",a.style.fontSize="60%");a.style.left=window.innerWidth/
2-a.clientWidth/2+"px";a.style.height=window.innerHeight-40+"px";480>window.innerWidth&&(a.style.left="80px",a.style.width=window.innerWidth-a.offsetLeft-10-12+"px")}catch(d){}}function destroy_overlay(){var a=document.getElementById("overlay_container");a.parentNode.removeChild(a);overlay_is_out=!1;try{document.getElementById("audio_control_button").style.visibility="visible"}catch(d){}}
function log_visitor_data(a){function d(){var a=null;window.XMLHttpRequest?a=new XMLHttpRequest:window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"));return a}(function(a,e){var c=d();c.open("POST",a,!0);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(e);c.onreadystatechange=function(){4===c.readyState&&200!==c.status&&console.log("Logging error.")}})("assets/scripts/php/visitor_data_logger.php",a)};
